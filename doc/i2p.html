<!DOCTYPE HTML>
<html lang="en" class="light sidebar-visible" dir="ltr">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>i2p - Bitcoin Core Developer Documentation</title>


        <!-- Custom HTML head -->

        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff">

        <link rel="icon" href="../favicon.svg">
        <link rel="shortcut icon" href="../favicon.png">
        <link rel="stylesheet" href="../css/variables.css">
        <link rel="stylesheet" href="../css/general.css">
        <link rel="stylesheet" href="../css/chrome.css">
        <link rel="stylesheet" href="../css/print.css" media="print">

        <!-- Fonts -->
        <link rel="stylesheet" href="../FontAwesome/css/font-awesome.css">
        <link rel="stylesheet" href="../fonts/fonts.css">

        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" href="../highlight.css">
        <link rel="stylesheet" href="../tomorrow-night.css">
        <link rel="stylesheet" href="../ayu-highlight.css">

        <!-- Custom theme stylesheets -->


        <!-- Provide site root to javascript -->
        <script>
            var path_to_root = "../";
            var default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? "navy" : "light";
        </script>
        <!-- Start loading toc.js asap -->
        <script src="../toc.js"></script>
    </head>
    <body>
    <div id="body-container">
        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script>
            try {
                var theme = localStorage.getItem('mdbook-theme');
                var sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script>
            var theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            const html = document.documentElement;
            html.classList.remove('light')
            html.classList.add(theme);
            html.classList.add("js");
        </script>

        <input type="checkbox" id="sidebar-toggle-anchor" class="hidden">

        <!-- Hide / unhide sidebar before it is displayed -->
        <script>
            var sidebar = null;
            var sidebar_toggle = document.getElementById("sidebar-toggle-anchor");
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            } else {
                sidebar = 'hidden';
            }
            sidebar_toggle.checked = sidebar === 'visible';
            html.classList.remove('sidebar-visible');
            html.classList.add("sidebar-" + sidebar);
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            <!-- populated by js -->
            <mdbook-sidebar-scrollbox class="sidebar-scrollbox"></mdbook-sidebar-scrollbox>
            <noscript>
                <iframe class="sidebar-iframe-outer" src="../toc.html"></iframe>
            </noscript>
            <div id="sidebar-resize-handle" class="sidebar-resize-handle">
                <div class="sidebar-resize-indicator"></div>
            </div>
        </nav>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                <div id="menu-bar-hover-placeholder"></div>
                <div id="menu-bar" class="menu-bar sticky">
                    <div class="left-buttons">
                        <label id="sidebar-toggle" class="icon-button" for="sidebar-toggle-anchor" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                            <i class="fa fa-bars"></i>
                        </label>
                        <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                            <i class="fa fa-paint-brush"></i>
                        </button>
                        <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                            <li role="none"><button role="menuitem" class="theme" id="light">Light</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="rust">Rust</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="coal">Coal</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="navy">Navy</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="ayu">Ayu</button></li>
                        </ul>
                        <button id="search-toggle" class="icon-button" type="button" title="Search. (Shortkey: s)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="S" aria-controls="searchbar">
                            <i class="fa fa-search"></i>
                        </button>
                    </div>

                    <h1 class="menu-title">Bitcoin Core Developer Documentation</h1>

                    <div class="right-buttons">
                        <a href="../print.html" title="Print this book" aria-label="Print this book">
                            <i id="print-button" class="fa fa-print"></i>
                        </a>

                    </div>
                </div>

                <div id="search-wrapper" class="hidden">
                    <form id="searchbar-outer" class="searchbar-outer">
                        <input type="search" id="searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                    </form>
                    <div id="searchresults-outer" class="searchresults-outer hidden">
                        <div id="searchresults-header" class="searchresults-header"></div>
                        <ul id="searchresults">
                        </ul>
                    </div>
                </div>

                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script>
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <h1 id="i2p-support-in-bitcoin-core"><a class="header" href="#i2p-support-in-bitcoin-core">I2P support in Bitcoin Core</a></h1>
<p>It is possible to run Bitcoin Core as an
<a href="https://en.wikipedia.org/wiki/I2P">I2P (Invisible Internet Project)</a>
service and connect to such services.</p>
<p>This <a href="https://geti2p.net/en/about/glossary">glossary</a> may be useful to get
started with I2P terminology.</p>
<h2 id="run-bitcoin-core-with-an-i2p-router-proxy"><a class="header" href="#run-bitcoin-core-with-an-i2p-router-proxy">Run Bitcoin Core with an I2P router (proxy)</a></h2>
<p>A running I2P router (proxy) is required with the <a href="https://geti2p.net/en/docs/api/samv3">SAM</a>
application bridge enabled. The following routers are recommended for use with Bitcoin Core:</p>
<ul>
<li><a href="https://geti2p.net">i2prouter (I2P Router)</a>, the official implementation in
Java. The SAM bridge is not enabled by default; it must be started manually,
or configured to start automatically, in the Clients page in the
router console (<code>http://127.0.0.1:7657/configclients</code>) or in the <code>clients.config</code> file.</li>
<li><a href="https://github.com/PurpleI2P/i2pd">i2pd (I2P Daemon)</a>
(<a href="https://i2pd.readthedocs.io/en/latest">documentation</a>), a lighter
alternative in C++. It enables the SAM bridge by default.</li>
</ul>
<p>Note the IP address and port the SAM proxy is listening to; usually, it is
<code>127.0.0.1:7656</code>.</p>
<p>Once an I2P router with SAM enabled is up and running, use the following Bitcoin
Core configuration options:</p>
<pre><code>-i2psam=&lt;ip:port&gt;
     I2P SAM proxy to reach I2P peers and accept I2P connections (default:
     none)

-i2pacceptincoming
     Whether to accept inbound I2P connections (default: 1). Ignored if
     -i2psam is not set. Listening for inbound I2P connections is
     done through the SAM proxy, not by binding to a local address and
     port.
</code></pre>
<p>In a typical situation, this suffices:</p>
<pre><code>bitcoind -i2psam=127.0.0.1:7656
</code></pre>
<h2 id="additional-configuration-options-related-to-i2p"><a class="header" href="#additional-configuration-options-related-to-i2p">Additional configuration options related to I2P</a></h2>
<pre><code>-debug=i2p
</code></pre>
<p>Set the <code>debug=i2p</code> config logging option to see additional information in the
debug log about your I2P configuration and connections. Run <code>bitcoin-cli help logging</code> for more information.</p>
<pre><code>-onlynet=i2p
</code></pre>
<p>Make automatic outbound connections only to I2P addresses. Inbound and manual
connections are not affected by this option. It can be specified multiple times
to allow multiple networks, e.g. onlynet=onion, onlynet=i2p.</p>
<p>I2P support was added to Bitcoin Core in version 22.0 and there may be fewer I2P
peers than Tor or IP ones. Therefore, using I2P alone without other networks may
make a node more susceptible to <a href="https://en.bitcoin.it/wiki/Weaknesses#Sybil_attack">Sybil
attacks</a>. You can use
<code>bitcoin-cli -addrinfo</code> to see the number of I2P addresses known to your node.</p>
<p>Another consideration with <code>onlynet=i2p</code> is that the initial blocks download
phase when syncing up a new node can be very slow. This phase can be sped up by
using other networks, for instance <code>onlynet=onion</code>, at the same time.</p>
<p>In general, a node can be run with both onion and I2P hidden services (or
any/all of IPv4/IPv6/onion/I2P/CJDNS), which can provide a potential fallback if
one of the networks has issues.</p>
<h2 id="persistent-vs-transient-i2p-addresses"><a class="header" href="#persistent-vs-transient-i2p-addresses">Persistent vs transient I2P addresses</a></h2>
<p>The first time Bitcoin Core connects to the I2P router, it automatically
generates a persistent I2P address and its corresponding private key by default,
unless <code>-i2pacceptincoming=0</code> is set.  The private key is saved in a file named
<code>i2p_private_key</code> in the Bitcoin Core data directory.  The persistent I2P
address is used for making outbound connections and accepting inbound
connections.</p>
<p>In the I2P network, the receiver of an inbound connection sees the address of
the initiator.  This is unlike the Tor network, where the recipient does not
know who is connecting to it.</p>
<p>If your node is configured by setting <code>-i2pacceptincoming=0</code> to not accept
inbound I2P connections, then it will use a random transient I2P address for
itself on each outbound connection to make it harder to discriminate,
fingerprint or analyze it based on its I2P address.</p>
<p>I2P addresses are designed to be long-lived.  Waiting for tunnels to be built
for every peer connection adds delay to connection setup time.  Therefore, I2P
listening should only be turned off if really needed.</p>
<h2 id="fetching-i2p-related-information-from-bitcoin-core"><a class="header" href="#fetching-i2p-related-information-from-bitcoin-core">Fetching I2P-related information from Bitcoin Core</a></h2>
<p>There are several ways to see your I2P address in Bitcoin Core if accepting
incoming I2P connections (<code>-i2pacceptincoming</code>):</p>
<ul>
<li>in the "Local addresses" output of CLI <code>-netinfo</code></li>
<li>in the "localaddresses" output of RPC <code>getnetworkinfo</code></li>
<li>in the debug log (grep for <code>AddLocal</code>; the I2P address ends in <code>.b32.i2p</code>)</li>
</ul>
<p>To see which I2P peers your node is connected to, use <code>bitcoin-cli -netinfo 4</code>
or the <code>getpeerinfo</code> RPC (e.g. <code>bitcoin-cli getpeerinfo</code>).</p>
<p>You can use the <code>getnodeaddresses</code> RPC to fetch a number of I2P peers known to your node; run <code>bitcoin-cli help getnodeaddresses</code> for details.</p>
<h2 id="compatibility"><a class="header" href="#compatibility">Compatibility</a></h2>
<p>Bitcoin Core uses the <a href="https://geti2p.net/en/docs/api/samv3">SAM v3.1</a> protocol
to connect to the I2P network. Any I2P router that supports it can be used.</p>
<h2 id="ports-in-i2p-and-bitcoin-core"><a class="header" href="#ports-in-i2p-and-bitcoin-core">Ports in I2P and Bitcoin Core</a></h2>
<p>One particularity of SAM v3.1 is that it does not support ports,
unlike newer versions of SAM (v3.2 and up) that do support them and default the
port numbers to 0. From the point of view of peers that use newer versions of
SAM or other protocols that support ports, a SAM v3.1 peer is connecting to them
on port 0, from source port 0.</p>
<p>To allow future upgrades to newer versions of SAM, Bitcoin Core sets its
listening port to 0 when listening for incoming I2P connections and advertises
its own I2P address with port 0. Furthermore, it will not attempt to connect to
I2P addresses with a non-zero port number because with SAM v3.1 the destination
port (<code>TO_PORT</code>) is always set to 0 and is not in the control of Bitcoin Core.</p>
<h2 id="bandwidth"><a class="header" href="#bandwidth">Bandwidth</a></h2>
<p>By default, your node shares bandwidth and transit tunnels with the I2P network
in order to increase your anonymity with cover traffic, help the I2P router used
by your node integrate optimally with the network, and give back to the network.
It's important that the nodes of a popular application like Bitcoin contribute
as much to the I2P network as they consume.</p>
<p>It is possible, though strongly discouraged, to change your I2P router
configuration to limit the amount of I2P traffic relayed by your node.</p>
<p>With <code>i2pd</code>, this can be done by adjusting the <code>bandwidth</code>, <code>share</code> and
<code>transittunnels</code> options in your <code>i2pd.conf</code> file. For example, to limit total
I2P traffic to 256KB/s and share 50% of this limit for a maximum of 20 transit
tunnels:</p>
<pre><code>bandwidth = 256
share = 50

[limits]
transittunnels = 20
</code></pre>
<p>Similar bandwidth configuration options for the Java I2P router can be found in
<code>http://127.0.0.1:7657/config</code> under the "Bandwidth" tab.</p>
<p>Before doing this, please see the "Participating Traffic Considerations" section
in <a href="https://geti2p.net/en/docs/applications/embedding">Embedding I2P in your Application</a>.</p>
<p>In most cases, the default router settings should work fine.</p>
<h2 id="bundling-i2p-in-a-bitcoin-application"><a class="header" href="#bundling-i2p-in-a-bitcoin-application">Bundling I2P in a Bitcoin application</a></h2>
<p>Please see the "General Guidance for Developers" section in https://geti2p.net/en/docs/api/samv3
if you are developing a downstream application that may be bundling I2P with Bitcoin.</p>

                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->
                            <a rel="prev" href="../doc/guix.html" class="mobile-nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                                <i class="fa fa-angle-left"></i>
                            </a>

                            <a rel="next prefetch" href="../doc/init.html" class="mobile-nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                                <i class="fa fa-angle-right"></i>
                            </a>

                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">
                    <a rel="prev" href="../doc/guix.html" class="nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                        <i class="fa fa-angle-left"></i>
                    </a>

                    <a rel="next prefetch" href="../doc/init.html" class="nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                        <i class="fa fa-angle-right"></i>
                    </a>
            </nav>

        </div>




        <script>
            window.playground_copyable = true;
        </script>


        <script src="../elasticlunr.min.js"></script>
        <script src="../mark.min.js"></script>
        <script src="../searcher.js"></script>

        <script src="../clipboard.min.js"></script>
        <script src="../highlight.js"></script>
        <script src="../book.js"></script>

        <!-- Custom JS scripts -->


    </div>
    </body>
</html>
